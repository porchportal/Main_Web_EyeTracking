"use strict";(()=>{var a={};a.id=362,a.ids=[362,636,3220],a.modules={37:a=>{a.exports=import("uuid")},156:a=>{a.exports=require("next/dist/shared/lib/utils")},361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},623:(a,b,c)=>{c.r(b),c.d(b,{default:()=>h});var d=c(8732),e=c(2015),f=c(3211),g=c.n(f);function h({onImageSave:a,onClose:b,userId:c,existingImages:f={}}){let[h,i]=(0,e.useState)([]),[j,k]=(0,e.useState)([]),[l,m]=(0,e.useState)(!1),[n,o]=(0,e.useState)(!1),p=(0,e.useRef)(null),q=Object.entries(f).map(([a,b])=>({url:b,name:b.split("/").pop()||a,isExisting:!0,key:a})),r=a=>{a.preventDefault(),a.stopPropagation(),"dragenter"===a.type||"dragover"===a.type?m(!0):"dragleave"===a.type&&m(!1)},s=async()=>{if(0===h.length)return void alert("Please select at least one image");if(!c)return void alert("Please select a user first");o(!0);try{let d=new FormData;h.forEach((a,b)=>{d.append(`image_${b}`,a)}),d.append("userId",c),d.append("fileCount",h.length),console.log("Uploading files for user:",c),console.log("File count:",h.length);let e=await fetch("/api/admin/upload-image",{method:"POST",body:d});console.log("Response status:",e.status),console.log("Response headers:",e.headers);let f=await e.json();if(console.log("Response data:",f),!e.ok)throw Error(f.error||f.details||`HTTP ${e.status}: Failed to upload images`);if(!f.success)throw Error(f.error||"Failed to upload images");console.log("Upload successful, image paths:",f.imagePaths),a&&a(f.imagePaths),alert("Images uploaded successfully!"),b()}catch(a){console.error("Error uploading images:",a),console.error("Error stack:",a.stack),alert(`Failed to upload images: ${a.message}`)}finally{o(!1)}};return(0,d.jsx)("div",{className:g().canvaConfigModal,children:(0,d.jsxs)("div",{className:g().canvaConfigContent,children:[(0,d.jsxs)("h2",{children:[q.length>0?"Add More Images":"Image Upload Configuration",q.length>0&&(0,d.jsxs)("span",{className:g().existingCount,children:["(",q.length," existing)"]})]}),(0,d.jsxs)("div",{className:`${g().dropZone} ${l?g().dragActive:""}`,onDragEnter:r,onDragLeave:r,onDragOver:r,onDrop:a=>{a.preventDefault(),a.stopPropagation(),m(!1);let b=Array.from(a.dataTransfer.files),c=b.filter(a=>{let b="image/jpeg"===a.type||"image/png"===a.type||"image/jpg"===a.type,c=a.size<=0x3200000;return b||console.warn(`Skipped file ${a.name}: Invalid file type`),c||console.warn(`Skipped file ${a.name}: File too large (${(a.size/1024/1024).toFixed(2)}MB)`),b&&c}),d=b.length-c.length;d>0&&alert(`${d} file(s) were skipped. Only JPG, JPEG, and PNG files under 50MB are allowed.`),c.length>0&&(i(a=>[...a,...c]),c.forEach(a=>{let b=new FileReader;b.onload=b=>{k(c=>[...c,{url:b.target.result,name:a.name}])},b.readAsDataURL(a)}))},onClick:()=>p.current?.click(),children:[(0,d.jsx)("input",{ref:p,type:"file",accept:".jpg,.jpeg,.png",onChange:a=>{let b=Array.from(a.target.files),c=b.filter(a=>{let b="image/jpeg"===a.type||"image/png"===a.type||"image/jpg"===a.type,c=a.size<=0x3200000;return b||console.warn(`Skipped file ${a.name}: Invalid file type`),c||console.warn(`Skipped file ${a.name}: File too large (${(a.size/1024/1024).toFixed(2)}MB)`),b&&c}),d=b.length-c.length;d>0&&alert(`${d} file(s) were skipped. Only JPG, JPEG, and PNG files under 50MB are allowed.`),c.length>0&&(i(a=>[...a,...c]),c.forEach(a=>{let b=new FileReader;b.onload=b=>{k(c=>[...c,{url:b.target.result,name:a.name}])},b.readAsDataURL(a)}))},multiple:!0,style:{display:"none"}}),(0,d.jsxs)("div",{className:g().dropZoneText,children:[(0,d.jsx)("p",{children:"Drag and drop images here or click to select"}),(0,d.jsx)("p",{className:g().supportedFormats,children:"Supported formats: JPG, JPEG, PNG"})]})]}),(j.length>0||q.length>0)&&(0,d.jsxs)("div",{className:g().imagesContainer,children:[(0,d.jsxs)("h3",{className:g().imagesContainerTitle,children:[q.length>0?"All Images":"Selected Images",q.length>0&&(0,d.jsxs)("span",{className:g().imageCount,children:["(",q.length+j.length," total)"]})]}),(0,d.jsxs)("div",{className:g().imagesPreviewGrid,children:[q.map((a,b)=>(0,d.jsxs)("div",{className:`${g().previewItem} ${g().existingImage}`,children:[(0,d.jsx)("img",{src:a.url,alt:`Existing ${a.name}`,className:g().imagePreview}),(0,d.jsx)("div",{className:g().existingBadge,children:"Existing"}),(0,d.jsx)("span",{className:g().fileName,children:a.name})]},`existing-${a.key}`)),j.map((a,b)=>(0,d.jsxs)("div",{className:`${g().previewItem} ${g().newImage}`,children:[(0,d.jsx)("img",{src:a.url,alt:`Preview ${b+1}`,className:g().imagePreview}),(0,d.jsx)("button",{className:g().removeButton,onClick:a=>{a.stopPropagation(),i(a=>a.filter((a,c)=>c!==b)),k(a=>a.filter((a,c)=>c!==b))},children:"\xd7"}),(0,d.jsx)("div",{className:g().newBadge,children:"New"}),(0,d.jsx)("span",{className:g().fileName,children:a.name})]},`new-${b}`))]})]}),(0,d.jsxs)("div",{className:g().canvaConfigActions,children:[(0,d.jsx)("button",{onClick:s,className:g().saveButton,disabled:n||0===h.length,children:n?"Uploading...":q.length>0?"Add More Images":"Save Images"}),h.length>0&&(0,d.jsx)("button",{onClick:()=>{i([]),k([])},className:g().clearButton,disabled:n,children:"Clear New"}),(0,d.jsx)("button",{onClick:b,className:g().cancelButton,disabled:n,children:"Cancel"})]})]})})}},1322:a=>{a.exports=require("next/dist/shared/lib/router/utils/format-url")},2015:a=>{a.exports=require("react")},2326:a=>{a.exports=require("react-dom")},3103:a=>{a.exports=require("next/dist/shared/lib/router/utils/add-path-prefix")},3873:a=>{a.exports=require("path")},4055:(a,b,c)=>{c.r(b),c.d(b,{default:()=>i});var d=c(8732),e=c(2015),f=c(2418),g=c(3211),h=c.n(g);function i({onOrderChange:a,initialOrder:b=""}){let[c,g]=(0,e.useState)([{id:1,name:"Show preview",priority:1,description:"High priority task",hasPriority:!0},{id:2,name:"Set Calibrate",priority:2,description:"Medium priority task",hasPriority:!0},{id:3,name:"Set Random",priority:null,description:"Low priority task",hasPriority:!1},{id:4,name:"Random Dot",priority:3,description:"Another task",hasPriority:!0}]),[i,j]=(0,e.useState)(null),[k,l]=(0,e.useState)(null),[m,n]=(0,e.useState)(null),[o,p]=(0,e.useState)(""),[q,r]=(0,e.useState)({show:!1,message:"",type:""}),[s,t]=(0,e.useState)(!1),u=a=>{a.target.style.opacity="1",a.target.style.transform="scale(1)",a.target.style.transition="all 0.3s ease",a.target.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)",a.target.style.zIndex="auto",j(null),l(null)},v=a=>{a.preventDefault(),a.dataTransfer.dropEffect="move"},w=a=>{a.preventDefault(),a.currentTarget.contains(a.relatedTarget)||l(null)},x=async()=>{try{let b=c.filter(a=>a.hasPriority).sort((a,b)=>a.priority-b.priority).map(a=>`${a.name} (#${a.priority})`).join(" → ");a&&a(b),r({show:!0,message:"Button order saved successfully!",type:"success"}),setTimeout(()=>{r({show:!1,message:"",type:""})},3e3)}catch(a){console.error("Error saving button order:",a),r({show:!0,message:"Failed to save button order. Please try again.",type:"error"})}};return(0,d.jsxs)("div",{className:h().buttonOrderSection,children:[(0,d.jsx)("div",{className:h().taskList,children:c.sort((a,b)=>a.hasPriority&&!b.hasPriority?-1:!a.hasPriority&&b.hasPriority?1:a.hasPriority&&b.hasPriority?a.priority-b.priority:0).map(a=>(0,d.jsxs)("div",{"data-item-id":a.id,draggable:!0,onDragStart:b=>{j(a),b.dataTransfer.effectAllowed="move",b.target.style.opacity="0.6",b.target.style.transform="scale(1.05)",b.target.style.transition="all 0.2s ease",b.target.style.boxShadow="0 8px 16px rgba(0, 0, 0, 0.3)",b.target.style.zIndex="1000"},onDragEnd:u,onDragOver:v,onDragEnter:b=>{b.preventDefault(),i&&i.id!==a.id&&l(a)},onDragLeave:w,onDrop:b=>{b.preventDefault(),i&&i.id!==a.id&&(t(!0),l(null),setTimeout(()=>{let b=[...c],d=b.findIndex(a=>a.id===i.id),e=b.findIndex(b=>b.id===a.id),[f]=b.splice(d,1);b.splice(e,0,f),b.filter(a=>a.hasPriority).forEach((a,b)=>{a.priority=b+1}),g(b),setTimeout(()=>{t(!1)},300)},100))},className:`${h().taskCard} ${i&&i.id===a.id?h().taskCardDragging:""} ${k&&k.id===a.id?h().taskCardDropTarget:""} ${s?h().taskCardReordering:""}`,children:[(0,d.jsx)("input",{type:"checkbox",checked:a.hasPriority,onChange:()=>(a=>{let b=[...c],d=b.findIndex(b=>b.id===a),e=b[d];e.hasPriority=!e.hasPriority,e.hasPriority?e.priority=Math.max(0,...b.filter(b=>b.hasPriority&&b.id!==a).map(a=>a.priority||0))+1:(e.priority=null,b.filter(a=>a.hasPriority).forEach((a,b)=>{a.priority=b+1})),g(b),setTimeout(()=>{let b=document.querySelector(`[data-item-id="${a}"]`);b&&(b.style.animation="priorityPulse 0.6s ease",setTimeout(()=>{b.style.animation=""},600))},50)})(a.id),className:h().taskCheckbox}),(0,d.jsx)("span",{className:h().dragHandle,children:(0,d.jsx)(f.f2M,{size:18})}),(0,d.jsx)("span",{className:`${h().priorityBadge} ${!a.hasPriority?h().priorityBadgeGray:a.priority<=2?h().priorityBadgeRed:a.priority<=4?h().priorityBadgeYellow:h().priorityBadgeGreen}`,children:a.hasPriority?`#${a.priority}`:"N/A"}),(0,d.jsx)("div",{className:h().priorityInputContainer,children:(0,d.jsx)("input",{type:"number",min:"1",max:c.filter(a=>a.hasPriority).length,value:a.priority||"",onChange:b=>((a,b)=>{let d=parseInt(b),e=c.filter(a=>a.hasPriority);if(d<1||d>e.length)return;let f=[...c],h=f.findIndex(b=>b.id===a);if(!f[h].hasPriority)return;let i=f.filter(a=>a.hasPriority),j=i.find(b=>b.id===a),k=i.filter(b=>b.id!==a);k.splice(d-1,0,j),k.forEach((a,b)=>{a.priority=b+1}),g(f)})(a.id,b.target.value),disabled:!a.hasPriority,className:h().priorityInput})}),(0,d.jsx)("div",{className:h().taskContent,children:(0,d.jsx)("div",{className:h().taskInfoRow,children:(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:h().taskName,children:a.name}),(0,d.jsx)("span",{className:h().taskDesc,children:a.description})]})})})]},a.id))}),(0,d.jsxs)("div",{className:h().saveOrderContainer,children:[(0,d.jsxs)("button",{onClick:x,className:h().saveOrderButton,children:[(0,d.jsx)(f.eMP,{size:16}),"Save Button Order"]}),q.show&&(0,d.jsx)("div",{className:`${h().saveStatus} ${h()[q.type]}`,children:q.message})]}),(0,d.jsxs)("div",{className:h().orderSummaryBox,children:[(0,d.jsx)("div",{className:h().orderSummaryTitle,children:"Current Order:"}),(0,d.jsxs)("div",{className:h().orderSummaryRow,children:[(0,d.jsx)("strong",{children:"With Priority:"}),0===c.filter(a=>a.hasPriority).length?(0,d.jsx)("span",{className:h().orderSummaryNone,children:" None"}):c.filter(a=>a.hasPriority).sort((a,b)=>a.priority-b.priority).map((a,b)=>(0,d.jsxs)("span",{children:[b>0&&" → ",a.name," (#",a.priority,")"]},a.id))]}),(0,d.jsxs)("div",{className:h().orderSummaryRow,children:[(0,d.jsx)("strong",{children:"Without Priority:"}),0===c.filter(a=>!a.hasPriority).length?(0,d.jsx)("span",{className:h().orderSummaryNone,children:" None"}):c.filter(a=>!a.hasPriority).map((a,b)=>(0,d.jsxs)("span",{children:[b>0&&", ",a.name]},a.id))]})]})]})}},4075:a=>{a.exports=require("zlib")},5748:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{config:()=>L,default:()=>H,getServerSideProps:()=>K,getStaticPaths:()=>J,getStaticProps:()=>I,handler:()=>G,reportWebVitals:()=>M,routeModule:()=>S,unstable_getServerProps:()=>Q,unstable_getServerSideProps:()=>R,unstable_getStaticParams:()=>P,unstable_getStaticPaths:()=>O,unstable_getStaticProps:()=>N});var e=c(3885),f=c(237),g=c(772),h=c(2410),i=c(1322),j=c(5124),k=c(8647),l=c(3709),m=c(7909),n=c(5122),o=c(1413),p=c(9616),q=c.n(p),r=c(7522),s=c(9032),t=c(6755),u=c(156),v=c(12),w=c(2072),x=c(8164),y=c(4971),z=c(8737),A=c(6439),B=c(5735),C=c(6713),D=c(3103),E=c(5952),F=a([r,s]);[r,s]=F.then?(await F)():F;let H=(0,o.M)(s,"default"),I=(0,o.M)(s,"getStaticProps"),J=(0,o.M)(s,"getStaticPaths"),K=(0,o.M)(s,"getServerSideProps"),L=(0,o.M)(s,"config"),M=(0,o.M)(s,"reportWebVitals"),N=(0,o.M)(s,"unstable_getStaticProps"),O=(0,o.M)(s,"unstable_getStaticPaths"),P=(0,o.M)(s,"unstable_getStaticParams"),Q=(0,o.M)(s,"unstable_getServerProps"),R=(0,o.M)(s,"unstable_getServerSideProps"),S=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/admin_ui/admin",pathname:"/admin_ui/admin",bundlePath:"",filename:""},distDir:".next",projectDir:"",components:{App:r.default,Document:q()},userland:s});async function G(a,b,c){var d,e;let o="/admin_ui/admin";"/index"===o&&(o="/");let p="false",q=await S.prepare(a,b,{srcPage:o,multiZoneDraftMode:p});if(!q){b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve());return}let{buildId:r,query:F,params:G,parsedUrl:H,originalQuery:M,originalPathname:N,buildManifest:O,nextFontManifest:P,serverFilesManifest:Q,reactLoadableManifest:R,prerenderManifest:T,isDraftMode:U,isOnDemandRevalidate:V,revalidateOnlyGenerated:W,locale:X,locales:Y,defaultLocale:Z,routerServerContext:$,nextConfig:_,resolvedPathname:aa}=q,ab=null==Q||null==(e=Q.config)||null==(d=e.experimental)?void 0:d.isExperimentalCompile,ac=!!K,ad=!!I,ae=!!J,af=!!(s.default||s).getInitialProps,ag=F.amp&&L.amp,ah=null,ai=!1,aj=q.isNextDataRequest&&(ad||ac),ak="/404"===o,al="/500"===o,am="/_error"===o;if(S.isDev||U||!ad||(ah=`${X?`/${X}`:""}${("/"===o||"/"===aa)&&X?"":aa}${ag?".amp":""}`,(ak||al||am)&&(ah=`${X?`/${X}`:""}${o}${ag?".amp":""}`),ah="/index"===ah?"/":ah),ae&&!U){let a=(0,E.removeTrailingSlash)(X?(0,D.addPathPrefix)(aa,`/${X}`):aa),b=!!T.routes[a]||T.notFoundRoutes.includes(a),c=T.dynamicRoutes[o];if(c){if(!1===c.fallback&&!b)throw new A.NoFallbackError;"string"!=typeof c.fallback||b||aj||(ai=!0)}}(ai&&(0,C.isBot)(a.headers["user-agent"]||"")||(0,j.getRequestMeta)(a,"minimalMode"))&&(ai=!1);let an=(0,h.getTracer)(),ao=an.getActiveScopeSpan();try{let d=a.method||"GET",e=(0,i.formatUrl)({pathname:_.trailingSlash?H.pathname:(0,E.removeTrailingSlash)(H.pathname||"/"),query:ad?{}:M}),q=(null==$?void 0:$.publicRuntimeConfig)||_.publicRuntimeConfig,A=async h=>{var A,C;let D,E=async({previousCacheEntry:t})=>{var u;let v=async()=>{try{var c,f,u;return await S.render(a,b,{query:ad&&!ab?{...G,...ag?{amp:F.amp}:{}}:{...F,...G},params:G,page:o,renderContext:{isDraftMode:U,isFallback:ai,developmentNotFoundSourcePage:(0,j.getRequestMeta)(a,"developmentNotFoundSourcePage")},sharedContext:{buildId:r,customServer:!!(null==$?void 0:$.isCustomServer)||void 0,deploymentId:!1},renderOpts:{params:G,routeModule:S,page:o,pageConfig:L||{},Component:(0,k.T)(s),ComponentMod:s,getStaticProps:I,getStaticPaths:J,getServerSideProps:K,supportsDynamicResponse:!ad,buildManifest:O,nextFontManifest:P,reactLoadableManifest:R,assetPrefix:_.assetPrefix,strictNextHead:_.experimental.strictNextHead??!0,previewProps:T.preview,images:_.images,nextConfigOutput:_.output,optimizeCss:!!_.experimental.optimizeCss,nextScriptWorkers:!!_.experimental.nextScriptWorkers,domainLocales:null==(c=_.i18n)?void 0:c.domains,crossOrigin:_.crossOrigin,multiZoneDraftMode:p,basePath:_.basePath,canonicalBase:_.amp.canonicalBase||"",ampOptimizerConfig:null==(f=_.experimental.amp)?void 0:f.optimizer,disableOptimizedLoading:_.experimental.disableOptimizedLoading,largePageDataBytes:_.experimental.largePageDataBytes,runtimeConfig:Object.keys(q).length>0?q:void 0,isExperimentalCompile:ab,experimental:{clientTraceMetadata:_.experimental.clientTraceMetadata||[]},locale:X,locales:Y,defaultLocale:Z,setIsrStatus:null==$?void 0:$.setIsrStatus,isNextDataRequest:aj&&(ac||ad),resolvedUrl:e,resolvedAsPath:ac||af?(0,i.formatUrl)({pathname:aj?(0,m.normalizeDataPath)(N):N,query:M}):e,isOnDemandRevalidate:V,ErrorDebug:(0,j.getRequestMeta)(a,"PagesErrorDebug"),err:(0,j.getRequestMeta)(a,"invokeError"),dev:S.isDev,distDir:`${S.projectDir}/${S.distDir}`,ampSkipValidation:null==(u=_.experimental.amp)?void 0:u.skipValidation,ampValidator:(0,j.getRequestMeta)(a,"ampValidator")}}).then(a=>{let{metadata:b}=a,c=b.cacheControl;return"isNotFound"in b&&b.isNotFound?{value:null,cacheControl:c}:b.isRedirect?{value:{kind:n.CachedRouteKind.REDIRECT,props:b.pageData??b.flightData},cacheControl:c}:{value:{kind:n.CachedRouteKind.PAGES,html:a,pageData:a.metadata.pageData,headers:a.metadata.headers,status:a.metadata.statusCode},cacheControl:c}}).finally(()=>{if(!h)return;h.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let c=an.getRootSpanAttributes();if(!c)return;if(c.get("next.span_type")!==g.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${c.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=c.get("next.route");if(e){let a=`${d} ${e}`;h.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),h.updateName(a)}else h.updateName(`${d} ${a.url}`)})}catch(b){throw(null==t?void 0:t.isStale)&&await S.onRequestError(a,b,{routerKind:"Pages Router",routePath:o,routeType:"render",revalidateReason:(0,l.c)({isRevalidate:ad,isOnDemandRevalidate:V})},$),b}};if(t&&(ai=!1),ai){let b=await S.getResponseCache(a).get(S.isDev?null:X?`/${X}${o}`:o,async({previousCacheEntry:a=null})=>S.isDev?v():(0,z.toResponseCacheEntry)(a),{routeKind:f.RouteKind.PAGES,isFallback:!0,isRoutePPREnabled:!1,isOnDemandRevalidate:!1,incrementalCache:await S.getIncrementalCache(a,_,T),waitUntil:c.waitUntil});if(b)return delete b.cacheControl,b.isMiss=!0,b}return!(0,j.getRequestMeta)(a,"minimalMode")&&V&&W&&!t?(b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null):ai&&(null==t||null==(u=t.value)?void 0:u.kind)===n.CachedRouteKind.PAGES?{value:{kind:n.CachedRouteKind.PAGES,html:new y.default(Buffer.from(t.value.html),{contentType:"text/html;utf-8",metadata:{statusCode:t.value.status,headers:t.value.headers}}),pageData:{},status:t.value.status,headers:t.value.headers},cacheControl:{revalidate:0,expire:void 0}}:v()},Q=await S.handleResponse({cacheKey:ah,req:a,nextConfig:_,routeKind:f.RouteKind.PAGES,isOnDemandRevalidate:V,revalidateOnlyGenerated:W,waitUntil:c.waitUntil,responseGenerator:E,prerenderManifest:T});if(!ai||(null==Q?void 0:Q.isMiss)||(ai=!1),Q){if(ad&&!(0,j.getRequestMeta)(a,"minimalMode")&&b.setHeader("x-nextjs-cache",V?"REVALIDATED":Q.isMiss?"MISS":Q.isStale?"STALE":"HIT"),!ad||ai)b.getHeader("Cache-Control")||(D={revalidate:0,expire:void 0});else if(ak){let b=(0,j.getRequestMeta)(a,"notFoundRevalidate");D={revalidate:void 0===b?0:b,expire:void 0}}else if(al)D={revalidate:0,expire:void 0};else if(Q.cacheControl)if("number"==typeof Q.cacheControl.revalidate){if(Q.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${Q.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});D={revalidate:Q.cacheControl.revalidate,expire:(null==(A=Q.cacheControl)?void 0:A.expire)??_.expireTime}}else D={revalidate:w.CACHE_ONE_YEAR,expire:void 0};if(D&&!b.getHeader("Cache-Control")&&b.setHeader("Cache-Control",(0,t.getCacheControlHeader)(D)),!Q.value)return((0,j.addRequestMeta)(a,"notFoundRevalidate",null==(C=Q.cacheControl)?void 0:C.revalidate),b.statusCode=404,aj)?void b.end('{"notFound":true}'):void((null==$?void 0:$.render404)?await $.render404(a,b,H,!1):b.end("This page could not be found"));if(Q.value.kind===n.CachedRouteKind.REDIRECT)if(!aj)return await (a=>{let c={destination:a.pageProps.__N_REDIRECT,statusCode:a.pageProps.__N_REDIRECT_STATUS,basePath:a.pageProps.__N_REDIRECT_BASE_PATH},d=(0,v.getRedirectStatus)(c),{basePath:e}=_;e&&!1!==c.basePath&&c.destination.startsWith("/")&&(c.destination=`${e}${c.destination}`),c.destination.startsWith("/")&&(c.destination=(0,u.normalizeRepeatedSlashes)(c.destination)),b.statusCode=d,b.setHeader("Location",c.destination),d===B.RedirectStatusCode.PermanentRedirect&&b.setHeader("Refresh",`0;url=${c.destination}`),b.end(c.destination)})(Q.value.props),null;else{b.setHeader("content-type","application/json"),b.end(JSON.stringify(Q.value.props));return}if(Q.value.kind!==n.CachedRouteKind.PAGES)throw Object.defineProperty(Error("Invariant: received non-pages cache entry in pages handler"),"__NEXT_ERROR_CODE",{value:"E695",enumerable:!1,configurable:!0});if(S.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),U&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),(0,j.getRequestMeta)(a,"customErrorRender")||am&&(0,j.getRequestMeta)(a,"minimalMode")&&500===b.statusCode)return null;await (0,x.sendRenderResult)({req:a,res:b,result:!aj||am||al?Q.value.html:new y.default(Buffer.from(JSON.stringify(Q.value.pageData)),{contentType:"application/json",metadata:Q.value.html.metadata}),generateEtags:_.generateEtags,poweredByHeader:_.poweredByHeader,cacheControl:S.isDev?void 0:D,type:aj?"json":"html"})}};ao?await A():await an.withPropagatedContext(a.headers,()=>an.trace(g.BaseServerSpan.handleRequest,{spanName:`${d} ${a.url}`,kind:h.SpanKind.SERVER,attributes:{"http.method":d,"http.target":a.url}},A))}catch(b){throw b instanceof A.NoFallbackError||await S.onRequestError(a,b,{routerKind:"Pages Router",routePath:o,routeType:"render",revalidateReason:(0,l.c)({isRevalidate:ad,isOnDemandRevalidate:V})},$),b}}d()}catch(a){d(a)}})},5952:a=>{a.exports=require("next/dist/shared/lib/router/utils/remove-trailing-slash")},5976:(a,b,c)=>{c.r(b),c.d(b,{default:()=>h,useAdminSettings:()=>g});var d=c(2015);let e=(a,b)=>{if(a===b)return!0;if("object"!=typeof a||"object"!=typeof b||null===a||null===b)return!1;let c=Object.keys(a),d=Object.keys(b);return c.length===d.length&&c.every(c=>d.includes(c)&&e(a[c],b[c]))},f=(a,b)=>{},g=a=>{let[b,c]=(0,d.useState)({}),[g,h]=(0,d.useState)(()=>null),[i,j]=(0,d.useState)(!1),[k,l]=(0,d.useState)(null),m=(0,d.useRef)(!1),n=(0,d.useRef)(null),[o,p]=(0,d.useState)({}),[q,r]=(0,d.useState)(0),s=(0,d.useRef)(new Map),t=(0,d.useRef)(new Map),u=(0,d.useRef)(new Map),v=(0,d.useRef)(!1),w=(0,d.useRef)(new Map);(0,d.useEffect)(()=>{console.log("AdminSettings - Current Settings:",b),console.log("AdminSettings - Current User ID:",g),console.log("AdminSettings - Is TopBar Updated:",i)},[b,g,i]);let x=(0,d.useCallback)(async b=>{if(!b)return;let d=s.current.get(b),f=t.current.get(b),g=Date.now();if(d&&f&&g-f<3e4)return console.log("[AdminSettings] Using cached settings for user:",b),d;if(u.current.has(b))return console.log("[AdminSettings] Pending update exists, using cached value"),d;if(v.current)return console.log("[AdminSettings] Update in progress, using cached value"),d;try{v.current=!0,u.current.set(b,!0);let d=await fetch(`/api/data-center/settings/${b}`,{headers:{Accept:"application/json","Content-Type":"application/json","X-API-Key":process.env.NEXT_PUBLIC_API_KEY||"A1B2C3D4-E5F6-7890-GHIJ-KLMNOPQRSTUV"}});if(!d.ok){let a=await d.json().catch(()=>({}));throw Error(a.detail||"Failed to fetch settings")}let f=(await d.json()).data||{},h=w.current.get(b);return e(h,f)?console.log("[AdminSettings] Settings unchanged, skipping update"):(console.log("[AdminSettings] Settings changed, updating..."),c(a=>({...a,[b]:f})),p(f),s.current.set(b,f),t.current.set(b,g),w.current.set(b,f),a&&a.current&&a.current.setCaptureSettings&&(a.current.setCaptureSettings(f),j(!0))),l(null),f}catch(a){return console.error("[AdminSettings] Error fetching settings:",a),l(a.message),d}finally{v.current=!1,u.current.delete(b)}},[a]),y=(0,d.useCallback)(((a,b)=>{let c;return function(...b){clearTimeout(c),c=setTimeout(()=>{clearTimeout(c),a(...b)},1e3)}})(a=>{x(a)},0),[x]);(0,d.useEffect)(()=>{if(!g)return;let a=async()=>{let a=Date.now();if(!(a-q<2e3))try{await y(g),r(a)}catch(a){console.error("[AdminSettings] Polling error:",a)}};return a(),n.current=setInterval(a,5e3),()=>{n.current&&clearInterval(n.current)}},[g,q,y]),(0,d.useEffect)(()=>{let a=a=>{if(a.detail&&a.detail.userId){console.log("[handleUserIdChange] userId:",a.detail.userId);let b=a.detail.userId;h(b),f("currentUserId",b),x(b)}};return window.addEventListener("userIdChange",a),()=>window.removeEventListener("userIdChange",a)},[a]),(0,d.useEffect)(()=>{g&&!m.current&&(x(g),m.current=!0)},[g]),(0,d.useEffect)(()=>{if(i){let a=new CustomEvent("settingsUpdated",{detail:{type:"settings",userId:g,settings:b[g]}});window.dispatchEvent(a),j(!1)}},[i,g,b]),(0,d.useEffect)(()=>{try{let a=null;if(a){let b=JSON.parse(a);c(b)}}catch(a){console.warn("Error loading settings from localStorage:",a)}},[]),(0,d.useEffect)(()=>{if(m.current)try{f("adminSettings",JSON.stringify(b))}catch(a){console.warn("Error saving settings to localStorage:",a)}else m.current=!0},[b]),(0,d.useEffect)(()=>{if(b&&g){console.log("[settings useEffect] currentUserId:",g);let a=b[g];a&&p(a)}},[b,g]),(0,d.useEffect)(()=>{let a=a=>{if(a.detail&&"captureSettings"===a.detail.type){let{userId:b,times_set_random:d,delay_set_random:e}=a.detail;if(console.log("[handleSettingsUpdate] userId:",b,"currentUserId:",g,"times_set_random:",d,"delay_set_random:",e),b===g){let a={...o,times_set_random:void 0!==d?Number(d):o.times_set_random,delay_set_random:void 0!==e?Number(e):o.delay_set_random};console.log("[handleSettingsUpdate] Updated settings:",a),p(a),c(c=>({...c,[b]:a})),z(a,b)}}};return window.addEventListener("captureSettingsUpdate",a),()=>window.removeEventListener("captureSettingsUpdate",a)},[g,o]);let z=(0,d.useCallback)(async(a,d)=>{if(!d)return;let f=Date.now();if(f-q<2e3)return void console.log("[updateSettings] Skipping update - too soon after last update");let g={...b[d],...a};if(e(w.current.get(d),g))return void console.log("[updateSettings] Settings unchanged, skipping update");try{v.current=!0,u.current.set(d,!0);let a=await fetch(`http://localhost:80/api/data-center/settings/${d}`,{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":process.env.NEXT_PUBLIC_API_KEY||"A1B2C3D4-E5F6-7890-GHIJ-KLMNOPQRSTUV"},body:JSON.stringify(g)});if(!a.ok){let b=await a.json().catch(()=>({}));throw Error(b.detail||"Failed to save settings")}let b=(await a.json()).data||g;c(a=>({...a,[d]:b})),p(b),s.current.set(d,b),t.current.set(d,f),w.current.set(d,b),r(f),l(null)}catch(a){l(a.message)}finally{v.current=!1,u.current.delete(d)}},[b,q]);return{settings:b,currentSettings:o,currentUserId:g,error:k,updateSettings:x}};function h(){return null}},6338:a=>{a.exports=import("js-cookie")},6439:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external")},6713:a=>{a.exports=require("next/dist/shared/lib/router/utils/is-bot")},7909:a=>{a.exports=require("next/dist/shared/lib/page-path/normalize-data-path")},7910:a=>{a.exports=require("stream")},8732:a=>{a.exports=require("react/jsx-runtime")},9021:a=>{a.exports=require("fs")},9032:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{default:()=>v,getServerSideProps:()=>u});var e=c(8732),f=c(2015),g=c(9788),h=c.n(g),i=c(3211),j=c.n(i),k=c(3905),l=c(5976),m=c(9021),n=c.n(m),o=c(3873),p=c.n(o),q=c(4055),r=c(623),s=c(4233),t=a([k]);k=(t.then?(await t)():t)[0];let w=process.env.NEXT_PUBLIC_API_URL||"http://nginx";async function u(){let a=p().join(process.cwd(),"public","admin","capture_settings.json"),b={default:{times:1,delay:3}};try{if(n().existsSync(a)){let c=n().readFileSync(a,"utf8");b=JSON.parse(c)}else{let c=p().dirname(a);n().existsSync(c)||n().mkdirSync(c,{recursive:!0}),n().writeFileSync(a,JSON.stringify(b,null,2))}}catch(a){console.error("Error reading/writing settings:",a)}return{props:{initialSettings:b}}}function v({initialSettings:a}){(0,s.useRouter)();let[b,c]=(0,f.useState)([]),[d,g]=(0,f.useState)(!0),[i,m]=(0,f.useState)(null),{userId:n,consentStatus:o}=(0,k.S)(),p=(0,f.useRef)(null),{settings:t,updateSettings:u}=(0,l.useAdminSettings)(p),[v,x]=(0,f.useState)(a),[y,z]=(0,f.useState)(null),[A,B]=(0,f.useState)({show:!1,message:""}),[C,D]=(0,f.useState)(""),[E,F]=(0,f.useState)("default");(0,f.useRef)(null);let[G,H]=(0,f.useState)({}),[I,J]=(0,f.useState)(!1),[K,L]=(0,f.useState)(null),[M,N]=(0,f.useState)(""),[O,P]=(0,f.useState)(""),[Q,R]=(0,f.useState)(!1),[S,T]=(0,f.useState)(!1),[U,V]=(0,f.useState)(!1),[W,X]=(0,f.useState)(!1),[Y,Z]=(0,f.useState)(!1),[$,_]=(0,f.useState)(!1),[aa,ab]=(0,f.useState)(!1),[ac,ad]=(0,f.useState)(!1),[ae,af]=(0,f.useState)(!1),[ag,ah]=(0,f.useState)(!1),ai=async()=>{if(!E||"default"===E)return void al("Please select a user ID before saving settings!","error");try{let a=v[E];if(!a)throw Error("No settings found for selected user");let b={...a},c=await fetch(`/api/data-center/settings/${E}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok)throw Error("Failed to save settings to data center");let d=await c.json();if(!d.success)throw Error(d.message||"Failed to save settings");x(a=>({...a,[E]:b})),u(b,E),al("Settings saved successfully to data center!","success")}catch(a){console.error("Error saving settings:",a),al("Failed to save settings. Please try again.","error")}},aj=async a=>{if(E){x(b=>({...b,[E]:{...b[E],buttons_order:a}}));try{let b={...v[E]||{},buttons_order:a};(await fetch(`/api/data-center/settings/${E}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).ok?al("Button order saved to data center!","success"):al("Failed to save button order to data center","error")}catch(a){console.error("Error saving button order:",a),al("Failed to save button order","error")}}},ak=async a=>{if(!E||"default"===E){P("Please select a user ID before changing zoom level!"),setTimeout(()=>P(""),3e3);return}try{if(!(await fetch("/api/data-center/zoom",{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":process.env.NEXT_PUBLIC_API_KEY},body:JSON.stringify({userId:E,zoomLevel:a})})).ok)throw Error("Failed to update zoom level");N("Zoom level updated successfully!"),setTimeout(()=>N(""),3e3)}catch(a){console.error("Error updating zoom level:",a),P("Failed to update zoom level. Please try again."),setTimeout(()=>P(""),3e3)}},al=(a,b="success")=>{B({show:!0,message:a,type:b}),setTimeout(()=>{B(a=>({...a,show:!1}))},3e3)},am=async()=>{try{let a=process.env.NEXT_PUBLIC_API_KEY||"A1B2C3D4-E5F6-7890-GHIJ-KLMNOPQRSTUV";console.log("Using API Key:",a);let b=await fetch(`${w}/consent/${K}`,{method:"DELETE",headers:{"Content-Type":"application/json","X-API-Key":a}});if(!b.ok){let a=await b.json().catch(()=>({}));throw console.error("Delete error response:",{status:b.status,statusText:b.statusText,errorData:a}),Error("Failed to delete user data")}try{let b=await fetch("/api/admin/delete-consent",{method:"POST",headers:{"Content-Type":"application/json","X-API-Key":a},body:JSON.stringify({userId:K})});if(!b.ok){let a=await b.json().catch(()=>({}));throw console.error("Local consent deletion error:",{status:b.status,statusText:b.statusText,errorData:a}),Error("Failed to delete local consent file")}}catch(a){throw console.error("Error deleting local consent file:",a),a}c(a=>a.filter(a=>a.userId!==K)),x(a=>{let b={...a};return delete b[K],b}),t&&t[K]&&u(null,K);try{for(let a of document.cookie.split(";")){let[b]=a.split("=");(b.trim().startsWith("eye_tracking_")||b.trim().startsWith("consent_")||b.trim().startsWith("user_"))&&(document.cookie=`${b.trim()}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`)}}catch(a){console.warn("Error clearing cookies:",a)}await new Promise(a=>setTimeout(a,1e3));let d=await fetch(`${w}/consent/${K}`,{method:"GET",headers:{"Content-Type":"application/json","X-API-Key":a}});404===d.status?al("User data deleted successfully from all collections!"):d.ok?(console.warn("User data might still exist in some collections"),al("User data deleted, but some collections might need manual cleanup")):al("User data deleted successfully from all collections!")}catch(a){console.error("Error deleting user data:",a),al("Failed to delete user data. Please try again.","error")}finally{J(!1),L(null)}},an=async()=>{if(!E||"default"===E)return void al("Please select a user ID before changing system controls!","error");try{let a=!Y,b={...v[E]||{},public_data_access:a};Z(a),x(a=>({...a,[E]:b})),(await fetch(`/api/data-center/settings/${E}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).ok?al(`Public access ${a?"enabled":"disabled"} and saved to data center!`,"success"):(Z(!a),al("Failed to save public access setting","error"))}catch(a){console.error("Error toggling public access:",a),al("Failed to update public access setting","error")}},ao=async()=>{if(!E||"default"===E)return void al("Please select a user ID before changing system controls!","error");try{let a=!$,b={...v[E]||{},enable_background_change:a};_(a),x(a=>({...a,[E]:b})),(await fetch(`/api/data-center/settings/${E}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).ok?al(`Backend change ${a?"enabled":"disabled"} and saved to data center!`,"success"):(_(!a),al("Failed to save backend change setting","error"))}catch(a){console.error("Error toggling backend change:",a),al("Failed to update backend change setting","error")}},ap=async a=>{let b=a.target.value;if(F(b),b)try{let a=await fetch(`/api/data-center/settings/${b}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(a.ok){let c=(await a.json()).data||{};x(a=>({...a,[b]:c})),u(c,b),Z(c.public_data_access||!1),_(c.enable_background_change||!1),N("Settings loaded successfully from data center!"),setTimeout(()=>N(""),3e3)}else x(a=>({...a,[b]:{}})),u({},b),Z(!1),_(!1),N("New user - settings will be created when you save"),setTimeout(()=>N(""),3e3)}catch(a){console.error("Error loading user settings:",a),P("Failed to load user settings. Using defaults."),setTimeout(()=>P(""),3e3),x(a=>({...a,[b]:{}})),u({},b),Z(!1),_(!1)}else x(a=>({...a,[b]:null}));P("")};return!W||d?(0,e.jsx)("div",{className:j().container,children:(0,e.jsxs)("div",{className:j().loadingContainer,children:[(0,e.jsx)("h1",{children:"Loading Admin Dashboard..."}),(0,e.jsx)("div",{className:j().loadingSpinner}),(0,e.jsx)("p",{children:"Please wait while we authenticate and load your data..."})]})}):i?(0,e.jsxs)("div",{className:j().preferencesContainer,children:[(0,e.jsx)("h1",{children:"Error"}),(0,e.jsx)("p",{children:i})]}):(0,e.jsxs)("div",{className:j().container,children:[(0,e.jsx)(h(),{children:(0,e.jsx)("title",{children:"Admin Dashboard"})}),(0,e.jsxs)("main",{className:j().main,children:[(0,e.jsx)("div",{className:j().headerContainer,children:(0,e.jsx)("h1",{children:"Admin Dashboard"})}),A.show&&(0,e.jsx)("div",{className:`${j().notification} ${"error"===A.type?j().notificationError:j().notificationSuccess}`,children:(0,e.jsxs)("div",{className:j().notificationContent,children:[(0,e.jsx)("span",{className:j().notificationIcon,children:"success"===A.type?"✓":"⚠"}),(0,e.jsx)("span",{className:j().notificationMessage,children:A.message})]})}),C&&(0,e.jsx)("div",{className:j().debugInfo,children:(0,e.jsx)("p",{children:(0,e.jsx)("small",{children:C})})}),M&&(0,e.jsx)("div",{className:j().successMessage,children:M}),O&&(0,e.jsx)("div",{className:j().errorMessage,children:O}),(0,e.jsxs)("div",{className:j().settingsSection,children:[(0,e.jsx)("h2",{children:"Consent Data"}),(0,e.jsxs)("div",{className:j().consentTable,children:[(0,e.jsxs)("table",{children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:"User ID"}),(0,e.jsx)("th",{children:"Consent Status"}),(0,e.jsx)("th",{children:"Profile"}),(0,e.jsx)("th",{children:"Timestamp"}),(0,e.jsx)("th",{children:"Received At"}),(0,e.jsx)("th",{children:"Actions"})]})}),(0,e.jsx)("tbody",{children:b.slice(0,S?b.length:5).map((a,b)=>(0,e.jsxs)("tr",{className:`${U?S?j().expanding:j().collapsing:""}`,style:{animationDelay:`${.05*b}s`},children:[(0,e.jsx)("td",{children:a.userId}),(0,e.jsx)("td",{children:a.status?"Accepted":"Declined"}),(0,e.jsx)("td",{children:(a=>{let b=G[a];return b?b.username&&b.sex?`Complete (${b.username}, ${b.sex}${b.age?`, ${b.age}`:""})`:"Incomplete":"No profile"})(a.userId)}),(0,e.jsx)("td",{children:new Date(a.timestamp).toLocaleString()}),(0,e.jsx)("td",{children:new Date(a.receivedAt).toLocaleString()}),(0,e.jsx)("td",{children:(0,e.jsxs)("div",{className:j().actionButtons,children:[!a.status&&(0,e.jsx)("button",{className:j().overrideButton,onClick:()=>(a=>{try{let b=new CustomEvent("adminOverride",{detail:{type:"adminOverride",userId:a,enabled:!0}});window.dispatchEvent(b),al(`Access granted for user ${a}!`)}catch(a){console.error("Error overriding access:",a),al("Failed to override access. Please try again.","error")}})(a.userId),children:"Grant Access"}),(0,e.jsx)("button",{className:j().deleteButton,onClick:()=>{var b;return b=a.userId,void(L(b),J(!0))},children:"Delete"})]})})]},b))})]}),b.length>5&&(0,e.jsx)("div",{className:j().showMoreContainer,children:(0,e.jsx)("button",{className:j().showMoreButton,onClick:()=>{U||(V(!0),T(!S),setTimeout(()=>{V(!1)},500))},disabled:U,children:S?"Show Less":"Show More"})})]})]}),I&&(0,e.jsx)("div",{className:j().confirmationDialog,children:(0,e.jsxs)("div",{className:j().confirmationContent,children:[(0,e.jsx)("h3",{children:"Confirm Delete"}),(0,e.jsx)("p",{children:"Are you sure you want to delete this consent row?"}),(0,e.jsxs)("div",{className:j().confirmationButtons,children:[(0,e.jsx)("button",{className:j().confirmButton,onClick:am,children:"OK"}),(0,e.jsx)("button",{className:j().cancelButton,onClick:()=>{J(!1),L(null)},children:"Not"})]})]})}),(0,e.jsx)("div",{className:j().userSelectionSection,children:(0,e.jsxs)("div",{className:j().userSelectionContainer,children:[(0,e.jsx)("label",{className:j().userSelectionLabel,children:"Select User:"}),(0,e.jsxs)("select",{value:E,onChange:ap,className:j().userSelectionInput,children:[(0,e.jsx)("option",{value:"",children:"Select a user..."}),Array.from(new Set(b.map(a=>a.userId))).map(a=>(0,e.jsxs)("option",{value:a,children:["User: ",a]},a))]})]})}),aa&&(0,e.jsxs)("div",{className:`${j().settingsGrid} ${ac?E&&"default"!==E?j().settingsEnter:j().settingsExit:""}`,children:[(0,e.jsxs)("div",{className:j().div1,style:{marginLeft:"1rem"},children:[(0,e.jsx)("h2",{children:"Capture Settings on Set Random Action"}),(0,e.jsxs)("div",{className:j().settingsSubScroll,children:[(0,e.jsxs)("div",{className:j().settingItem,children:[(0,e.jsx)("label",{children:"Time(s):"}),(0,e.jsxs)("div",{className:j().numberInputContainer,children:[(0,e.jsx)("input",{type:"number",name:"times_set_random",value:v[E]?.times_set_random??1,onChange:a=>{let b=parseInt(a.target.value,10);!isNaN(b)&&b>0&&x(a=>({...a,[E]:{...a[E],times_set_random:b}}))},min:"1",max:"100",className:j().numberInput,"data-control":"times_set_random"}),(0,e.jsxs)("div",{className:j().numberControls,children:[(0,e.jsx)("button",{className:j().numberControl,onClick:()=>{let a=v[E]?.times_set_random??1;a<100&&x(b=>({...b,[E]:{...b[E],times_set_random:a+1}}))},children:"▲"}),(0,e.jsx)("button",{className:j().numberControl,onClick:()=>{let a=v[E]?.times_set_random??1;a>1&&x(b=>({...b,[E]:{...b[E],times_set_random:a-1}}))},children:"▼"})]})]})]}),(0,e.jsxs)("div",{className:j().settingItem,children:[(0,e.jsx)("label",{children:"Delay(s):"}),(0,e.jsxs)("div",{className:j().numberInputContainer,children:[(0,e.jsx)("input",{type:"number",name:"delay_set_random",value:v[E]?.delay_set_random??3,onChange:a=>{let b=parseInt(a.target.value,10);!isNaN(b)&&b>0&&x(a=>({...a,[E]:{...a[E],delay_set_random:b}}))},min:"1",max:"60",className:j().numberInput,"data-control":"delay_set_random"}),(0,e.jsxs)("div",{className:j().numberControls,children:[(0,e.jsx)("button",{className:j().numberControl,onClick:()=>{let a=v[E]?.delay_set_random??3;a<60&&x(b=>({...b,[E]:{...b[E],delay_set_random:a+1}}))},children:"▲"}),(0,e.jsx)("button",{className:j().numberControl,onClick:()=>{let a=v[E]?.delay_set_random??3;a>1&&x(b=>({...b,[E]:{...b[E],delay_set_random:a-1}}))},children:"▼"})]})]})]}),(0,e.jsx)("div",{className:j().settingItem,children:(0,e.jsx)("button",{onClick:ai,className:j().saveButton,disabled:!E,children:"Save Settings"})})]})]}),(0,e.jsxs)("div",{className:j().div2,style:{marginLeft:"1rem"},children:[(0,e.jsx)("h2",{children:"Required Button Click Order"}),v[E]?.buttons_order&&(0,e.jsxs)("div",{className:j().currentOrderDisplay,children:[(0,e.jsx)("strong",{children:"Current Order:"})," ",v[E].buttons_order]}),(0,e.jsx)(q.default,{onOrderChange:aj,initialOrder:v[E]?.buttons_order||""})]}),(0,e.jsxs)("div",{className:j().div3,style:{marginLeft:"1rem"},children:[(0,e.jsx)("h2",{children:"Set Calibrate"}),(0,e.jsxs)("div",{className:j().settingsSubScroll,children:[(0,e.jsxs)("div",{className:j().settingItem,children:[(0,e.jsx)("label",{children:"Time(s):"}),(0,e.jsxs)("div",{className:j().numberInputContainer,children:[(0,e.jsx)("input",{type:"number",name:"times_set_calibrate",value:v[E]?.times_set_calibrate??1,onChange:a=>{let b=parseInt(a.target.value,10);!isNaN(b)&&b>0&&x(a=>({...a,[E]:{...a[E],times_set_calibrate:b}}))},min:"1",max:"100",className:j().numberInput,"data-control":"times_set_calibrate"}),(0,e.jsxs)("div",{className:j().numberControls,children:[(0,e.jsx)("button",{className:j().numberControl,onClick:()=>{let a=v[E]?.times_set_calibrate??1;a<100&&x(b=>({...b,[E]:{...b[E],times_set_calibrate:a+1}}))},children:"▲"}),(0,e.jsx)("button",{className:j().numberControl,onClick:()=>{let a=v[E]?.times_set_calibrate??1;a>1&&x(b=>({...b,[E]:{...b[E],times_set_calibrate:a-1}}))},children:"▼"})]})]})]}),(0,e.jsxs)("div",{className:`${j().settingItem} ${j().fadeInOut} ${(v[E]?.times_set_calibrate??1)>1?j().show:j().hide}`,children:[(0,e.jsx)("label",{children:"Run Set Random Every:"}),(0,e.jsxs)("div",{className:j().numberInputContainer,children:[(0,e.jsx)("input",{type:"number",name:"run_every_of_random",value:v[E]?.run_every_of_random??1,onChange:a=>{let b=parseInt(a.target.value,10);!isNaN(b)&&b>0&&x(a=>({...a,[E]:{...a[E],run_every_of_random:b}}))},min:"1",max:"100",className:j().numberInput,"data-control":"run_every_of_random"}),(0,e.jsxs)("div",{className:j().numberControls,children:[(0,e.jsx)("button",{className:j().numberControl,onClick:()=>{let a=v[E]?.run_every_of_random??1;a<100&&x(b=>({...b,[E]:{...b[E],run_every_of_random:a+1}}))},children:"▲"}),(0,e.jsx)("button",{className:j().numberControl,onClick:()=>{let a=v[E]?.run_every_of_random??1;a>1&&x(b=>({...b,[E]:{...b[E],run_every_of_random:a-1}}))},children:"▼"})]})]})]}),(0,e.jsx)("div",{className:j().settingItem,children:(0,e.jsx)("button",{onClick:ai,className:j().saveButton,disabled:!E,children:"Save Settings"})})]})]}),(0,e.jsxs)("div",{className:j().div4,style:{marginLeft:"1rem"},children:[(0,e.jsx)("h2",{children:"Image Background Settings"}),(0,e.jsxs)("div",{className:j().settingItem,children:[(0,e.jsx)("button",{onClick:()=>R(!0),className:j().uploadButton,children:"Choose Image"}),v[E]?.image_pdf_canva&&"object"==typeof v[E].image_pdf_canva&&Object.keys(v[E].image_pdf_canva).length>0&&(0,e.jsxs)("div",{className:j().currentImages,children:[(0,e.jsxs)("p",{children:["Images (",Object.keys(v[E].image_pdf_canva).length,"):"]}),Object.keys(v[E].image_pdf_canva).length>1&&(0,e.jsx)("div",{className:j().showAllImagesContainer,children:(0,e.jsxs)("button",{onClick:()=>{let a=v[E].image_pdf_canva,b=Object.entries(a),c=document.createElement("div");c.className=j().imageModal,c.innerHTML=`
                              <div class="${j().imageModalContent}">
                                <h3>All Images (${b.length})</h3>
                                <div class="${j().imageModalGrid}">
                                  ${b.map(([a,b])=>`
                                    <div class="${j().imageModalItem}">
                                      <img src="${b}" alt="${a}" class="${j().imageModalPreview}" />
                                      <p class="${j().imageModalName}">${a}</p>
                                    </div>
                                  `).join("")}
                                </div>
                                <button class="${j().imageModalClose}" onclick="this.parentElement.parentElement.remove()">Close</button>
                              </div>
                            `,document.body.appendChild(c)},className:j().showAllImagesButton,children:["Show All Images (",Object.keys(v[E].image_pdf_canva).length,")"]})}),(0,e.jsxs)("div",{className:j().imageList,children:[(0,e.jsx)("p",{children:"Image Paths:"}),Object.entries(v[E].image_pdf_canva).sort(([a],[b])=>{let c=parseInt(a.replace("image_path_","")),d=parseInt(b.replace("image_path_",""));return c-d}).map(([a,b])=>(0,e.jsxs)("div",{className:j().imagePathItem,children:[(0,e.jsxs)("strong",{children:[a,":"]})," ",b]},a))]})]}),v[E]?.image_path&&"/asfgrebvxcv"!==v[E].image_path&&""!==v[E].image_path&&(!v[E]?.image_pdf_canva||"object"!=typeof v[E].image_pdf_canva||0===Object.keys(v[E].image_pdf_canva).length)&&(0,e.jsxs)("div",{className:j().currentImage,children:[(0,e.jsxs)("p",{children:["Current Image: ",v[E].updateImage]}),(0,e.jsx)("img",{src:v[E].image_path,alt:"Current background",className:j().currentImagePreview,onError:a=>{a.target.style.display="none",a.target.nextSibling.style.display="block"}}),(0,e.jsx)("p",{className:j().imageError,style:{display:"none",color:"#dc3545",fontSize:"0.9rem"},children:"Image not found"})]})]}),(0,e.jsx)("div",{className:j().settingItem,children:(0,e.jsx)("button",{onClick:ai,className:j().saveButton,children:"Save Settings"})})]}),(0,e.jsxs)("div",{className:j().div5,style:{marginLeft:"1rem"},children:[(0,e.jsx)("h2",{children:"Zoom Control Respond"}),(0,e.jsxs)("div",{className:j().settingItem,children:[(0,e.jsx)("label",{children:"Zoom Level:"}),(0,e.jsxs)("div",{className:j().zoomControls,children:[(0,e.jsx)("button",{className:j().zoomButton,children:"-"}),(0,e.jsx)("input",{type:"number",min:"50",max:"200",className:j().zoomInput,onChange:a=>ak(a.target.value)}),(0,e.jsx)("span",{className:j().zoomPercent,children:"%"}),(0,e.jsx)("button",{className:j().zoomButton,children:"+"})]})]})]})]}),Q&&(0,e.jsx)(r.default,{onImageSave:a=>{if(E){let b,c,d,e=v[E]?.image_pdf_canva||{},f=v[E]?.image_path,g=v[E]?.updateImage;if("string"==typeof a)b=a,c=a.split("/").pop(),d={...e,image_path_1:a};else{if("object"!=typeof a||null===a)return void console.error("Invalid imagePaths format:",a);let h=a.Image_path_1||Object.values(a)[0];f&&"/asfgrebvxcv"!==f&&""!==f?(b=f,c=g):(b=h,c=h?h.split("/").pop():"");let i={};Object.entries(a).forEach(([a,b],c)=>{i[`image_path_${c+1}`]=b});let j=Object.keys(e).length;Object.entries(i).forEach(([a,b],c)=>{e[`image_path_${j+c+1}`]=b}),d=e}x(a=>({...a,[E]:{...a[E],image_path:b,updateImage:c,image_pdf_canva:d}})),al("Images added successfully!")}},onClose:()=>R(!1),userId:E,existingImages:v[E]?.image_pdf_canva||{}}),(0,e.jsxs)("div",{className:j().bottomControlSection,children:[ae&&(0,e.jsxs)("div",{className:`${j().controlBox} ${ag?E&&"default"!==E?j().systemControlsEnter:j().systemControlsExit:""}`,children:[(0,e.jsx)("h2",{children:"System Controls"}),(0,e.jsx)("div",{className:j().controlButtons,children:(0,e.jsxs)("div",{className:j().controlButtonGroup,children:[(0,e.jsxs)("button",{className:`${j().toggleButton} ${Y?j().toggleButtonActive:j().toggleButtonInactive}`,onClick:an,children:[(0,e.jsx)("span",{className:j().buttonIcon,children:"\uD83C\uDF10"}),(0,e.jsxs)("div",{className:j().buttonContent,children:[(0,e.jsxs)("span",{className:j().buttonTitle,children:[Y?"Disable":"Enable"," Public Access"]}),(0,e.jsx)("span",{className:j().buttonDescription,children:Y?"Public access is currently enabled":"Allow people to collect dataset without admin approval"})]}),(0,e.jsx)("span",{className:j().toggleIndicator,children:Y?"ON":"OFF"})]}),(0,e.jsxs)("button",{className:`${j().toggleButton} ${$?j().toggleButtonActive:j().toggleButtonInactive}`,onClick:ao,children:[(0,e.jsx)("span",{className:j().buttonIcon,children:"⚙️"}),(0,e.jsxs)("div",{className:j().buttonContent,children:[(0,e.jsxs)("span",{className:j().buttonTitle,children:[$?"Disable":"Enable"," Backend Change"]}),(0,e.jsx)("span",{className:j().buttonDescription,children:$?"Backend changes are currently enabled":"Allow dynamic backend configuration changes"})]}),(0,e.jsx)("span",{className:j().toggleIndicator,children:$?"ON":"OFF"})]})]})})]}),(0,e.jsxs)("div",{className:j().controlBox,children:[(0,e.jsx)("h2",{children:"Download Dataset"}),(0,e.jsx)("div",{className:j().downloadSection,children:(0,e.jsxs)("div",{className:j().downloadButtons,children:[(0,e.jsx)("button",{className:j().downloadButton,onClick:()=>{al("Downloading All Dataset...")},children:"\uD83D\uDCE5 Download All Dataset"}),(0,e.jsx)("button",{className:j().downloadButton,onClick:()=>{al("Downloading User Profiles...")},children:"\uD83D\uDC65 Download User Profiles"}),(0,e.jsx)("button",{className:j().downloadButton,onClick:()=>{al("Downloading Raw Dataset...")},children:"\uD83D\uDCCB Download Raw Dataset"}),(0,e.jsx)("button",{className:j().downloadButton,onClick:()=>{al("Downloading Enhance Dataset...")},children:"\uD83D\uDCCB Download Enhance Dataset"}),(0,e.jsx)("button",{className:j().downloadButton,onClick:()=>{al("Downloading Label Parameters...")},children:"\uD83D\uDCCB Download Label Parameters"})]})})]}),(0,e.jsx)("div",{className:j().downloadSection,style:{marginBottom:"4rem"},children:(0,e.jsx)("div",{className:j().downloadButtons,children:(0,e.jsx)("button",{className:j().downloadButton,onClick:async()=>{try{await fetch("/api/admin/auth",{method:"DELETE"}),window.location.href="/"}catch(a){console.error("Error during logout:",a),window.location.href="/"}},children:"\uD83C\uDFE0 Go Home Page (Logout)"})})})]})]})]})}d()}catch(a){d(a)}})}};var b=require("../../webpack-runtime.js");b.C(a);var c=b.X(0,[6089,7190,9616,5064,37,7522],()=>b(b.s=5748));module.exports=c})();