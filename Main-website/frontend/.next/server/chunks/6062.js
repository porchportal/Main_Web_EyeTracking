"use strict";exports.id=6062,exports.ids=[6062],exports.modules={6062:(a,b,c)=>{c.d(b,{default:()=>f}),c(2015);var d=c(3453);class e{constructor(a){this.handleRandomDot=async()=>{document.querySelectorAll(".dot-countdown, .backup-countdown, .test-countdown").forEach(a=>{a.parentNode&&a.parentNode.removeChild(a)}),"function"==typeof this.toggleTopBar&&this.toggleTopBar(!1),"function"==typeof this.setIsCapturing&&this.setIsCapturing(!0),"function"==typeof this.setProcessStatus&&this.setProcessStatus("Generating random dot..."),this.onStatusUpdate&&this.onStatusUpdate({processStatus:"Generating random dot...",isCapturing:!0}),setTimeout(async()=>{let a=this.getCanvas();if(a){this.enterFullscreen();let b=(0,d.b)(a);console.log("RandomDotAction: Generated position:",{position:b,canvasDimensions:{width:a.width,height:a.height},canvasStyle:{position:a.style.position,width:a.style.width,height:a.style.height},canvasRect:a.getBoundingClientRect()}),this.drawDot(b.x,b.y,12),this.setCurrentDot(b);try{await (0,d.Ls)({canvasRef:{current:a},position:b,captureCounter:this.captureCounter,saveImageToServer:this.saveImageToServer,setCaptureCounter:this.setCaptureCounter,setProcessStatus:this.setProcessStatus,toggleTopBar:this.toggleTopBar,onStatusUpdate:this.onStatusUpdate,captureFolder:"eye_tracking_captures"}),this.clearCanvas(),setTimeout(()=>{"function"==typeof this.setIsCapturing&&this.setIsCapturing(!1)},2200)}catch(a){console.error("Error in capture and preview process:",a),"function"==typeof this.setProcessStatus&&this.setProcessStatus("Error during capture process"),"function"==typeof this.setIsCapturing&&this.setIsCapturing(!1),setTimeout(()=>{"function"==typeof this.setProcessStatus&&this.setProcessStatus("")},3e3)}}else console.error("Canvas reference is null - cannot draw dot"),"function"==typeof this.setProcessStatus&&this.setProcessStatus("Error: Canvas not available"),"function"==typeof this.setIsCapturing&&this.setIsCapturing(!1)},200)},this.canvasRef=a.canvasRef,this.toggleTopBar=a.toggleTopBar,this.setIsCapturing=a.setIsCapturing,this.setProcessStatus=a.setProcessStatus,this.setCurrentDot=a.setCurrentDot,this.triggerCameraAccess=a.triggerCameraAccess,this.onStatusUpdate=a.onStatusUpdate,this.saveImageToServer=a.saveImageToServer,this.setCaptureCounter=a.setCaptureCounter,this.captureCounter=a.captureCounter,this.canvasManager=null,this.canvasUtils=null}getCanvas(){return this.canvasUtils&&"function"==typeof this.canvasUtils.getCanvas?this.canvasUtils.getCanvas():this.canvasManager&&"function"==typeof this.canvasManager.getCanvas?this.canvasManager.getCanvas()||this.canvasManager.createCanvas():this.canvasRef?.current||document.querySelector("#tracking-canvas")}enterFullscreen(){if(this.canvasUtils&&"function"==typeof this.canvasUtils.enterFullscreen)return this.canvasUtils.enterFullscreen();if(this.canvasManager&&"function"==typeof this.canvasManager.enterFullscreen)return this.canvasManager.enterFullscreen(),this.canvasManager.getCanvas();let a=this.getCanvas();if(a){document.body.appendChild(a),a.style.cssText=`
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 10;
        background-color: yellow;
        border: none;
        display: block;
        opacity: 1;
        pointer-events: auto;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      `,a.width=window.innerWidth,a.height=window.innerHeight;let b=a.getContext("2d");b.fillStyle="yellow",b.fillRect(0,0,a.width,a.height)}return a}exitFullscreen(){if(this.canvasUtils&&"function"==typeof this.canvasUtils.exitFullscreen)return this.canvasUtils.exitFullscreen();if(this.canvasManager&&"function"==typeof this.canvasManager.exitFullscreen)return this.canvasManager.exitFullscreen(),this.canvasManager.getCanvas();let a=this.getCanvas();return a&&((document.querySelector(".canvas-container")||document.querySelector(".main-content")||document.body).appendChild(a),a.style.position="relative",a.style.top="",a.style.left="",a.style.width="100%",a.style.height="100%",a.style.zIndex="",a.style.backgroundColor="yellow"),a}clearCanvas(){if(this.canvasUtils&&"function"==typeof this.canvasUtils.clear)return void this.canvasUtils.clear();if(this.canvasManager&&"function"==typeof this.canvasManager.clear)return void this.canvasManager.clear();let a=this.getCanvas();if(a){let b=a.getContext("2d");b.clearRect(0,0,a.width,a.height),b.fillStyle="yellow",b.fillRect(0,0,a.width,a.height)}}drawDot(a,b,c=12){if(this.canvasUtils&&"function"==typeof this.canvasUtils.drawDot)return this.canvasUtils.drawDot(a,b,c);let e=this.getCanvas();if(e){let f=e.getContext("2d");return(0,d.Pt)(f,a,b,c,!1),!0}return!1}}let f=e}};